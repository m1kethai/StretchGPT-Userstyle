/* ==UserStyle==
@name           StretchGPT: Extra-wide ChatGPT Conversations
@version        5.0.1
@author         m1kethai
@description    Improves ChatGPT conversation readability by removing the narrow fixed content width and replacing it with subtle, adaptive padding for a consistent UX across all screen sizes.
@namespace      https://userstyles.world/style/9821/stretchgpt-extra-wide-chatgpt-conversations
@preprocessor   less
@var checkbox enableAccentColor "Tint Message Backgrounds with Accent Color [Experimental]" 0
@var select     accentColor "Accent Color" {
	"Dark and Stormy*": "#353f51",
	"Purple Haze": "#807396",
	"Japanese Violet": "#5B3256",
	"Sharp Indigo": "#48007c",
	"Cyber Grape": "#58427C",
	"Super Blue Lavender": "#5a5b9f",
	"Deep Space": "#2D3142",
	"Black Pearl": "#1e272c",
	"Caviar": "#292a2d",
	"Black Sabbath": "#220022",
	"Tokyo Midnight": "#1a1a2e",
	"Obsidian Ash": "#343434",
	"Blue Moss": "#5D737E",
	"Dusty Turquoise": "#5a8a89",
	"Aged Sage": "#8da572",
	"Gameboy Teal": "#0ABFBC",
	"Emerald": "#0f380f",
	"Aztek": "#293432",
	"Deep Jungle": "#1A2421",
	"Dark Chocolate": "#3c2f2f",
	"Lukewarm Cocoa": "#9b7653",
	"Ancient Gold": "#b59410",
	"Cardamom": "#aaaa77",
	"Earl Grey": "#a6978a",
	"Cyprus": "#545a3e",
	"Lobster Bisque": "#FFDAB9",
	"Amaretto": "#ab6f60",
	"Raspberry": "#b0003a",
	"Red Velvet": "#7b0d1e",
	"Sakura Bloom": "#ff7b9c",
	"Hot Pink": "#ff69b4",
	"FF06B5": "#FF06B5",
}
@var checkbox   hideAvatars "Hide Avatars" 0
@var checkbox   mobileLayout "[Desktop Only] Mobile Message Layout on Desktop - Always show action buttons in a separate row below the text in ChatGPT responses (default behavior when 'Hide avatars' is active)" 0
@var checkbox   sidebarTweaks "[Desktop Only] Sidebar/Chat History UI Tweaks" 0

==/UserStyle== */

@-moz-document domain("chat.openai.com") {

	/********* MESSAGES *********/
	/* ===== Main/Outer Div ===== */
	div.w-full.border-b {
		--pt: 1rem;
		--pb: 1rem;
		--pl: max(calc(1vw*1rem), 1rem);
		--pr: max(calc(1vw*1rem), 1rem);

		padding: var(--pt) var(--pr) var(--pb) var(--pl);

		@media (min-width: 768px) {
			--pt: 1.5rem;
			--pl: 2vw;
			--pr: 2vw;
			@media (min-width: 1536px) {
				--pt: min(calc(3vh*1rem), 1.5rem);
				--pl: 1.5rem;
				--pr: 1.5rem;
			}
		}

		/* ===== User Message ===== */
		&.dark\:bg-gray-800 when(@mobileLayout = 1), (@hideAvatars = 1) {
			/* Reduce user messages' horiz. padding on hover to prevent absolutely positioned "edit" button from overlapping with text */
			@media (min-width: 1024px) {
				--pr: calc(1vw + 1.5rem);
				@media (min-width: 1536px) {
					--pr: calc(2vw + 2rem);
				}
			}
		}

		/* ===== ChatGPT Message ===== */
		&:not(.dark\:bg-gray-800) {
			div.relative.flex-col.gap-1.md\:gap-3 when(@mobileLayout = 1) and (@hideAvatars = 0) {
				@media (min-width: 1024px) {
					width: calc(100% - calc(1vw + 1.5rem));
					@media (min-width: 1536px) {
						width: calc(100% - calc(2vw + 2rem));
					}
				}
			}
		}

		/* ===== Inner Div ===== */
		.gizmo > md\:max-w-2xl.lg\:max-w-[38rem].gizmo\:md\:max-w-3xl.gizmo\:lg\:max-w-[40rem].gizmo\:xl\:max-w-[48rem].xl\:max-w-3xl {
			max-width: 90% !important;
		}

		> div.p-4.justify-center.m-auto {
			padding-top: 0;
			padding-bottom: 0;

			@media (max-width: 768px) {
				padding-left: 0;
				padding-right: 0;
			}

			// sidebar === closed
			> div.flex.flex-1.mx-auto.md\:max-w-3xl,
			// sidebar === open
			> div.flex.mx-auto.md\:max-w-2xl.lg\:max-w-\[38rem\].xl\:max-w-3xl,
			> div:only-child {
				max-width: 90% !important;
				gap: 0.5rem;
				padding: 0;

				@media (min-width: 1536px) {
					gap: 1rem;
				}

				/* ===== Hide Avatars ===== */
				& when(@hideAvatars = 1) {
					> div:first-child {
						display: none;
					}
					@media (min-width: 1536px) {
						padding-left: 0;
					}

					.markdown.prose > ol,
					.markdown.prose > ul {
						padding-left: max(calc(1vw * 1rem), 0.5rem);
					}
				}

				/* ===== Message Content Div===== */
				> div:last-child {
					padding: 0 !important;

					div.lg\:absolute.lg\:top-0.lg\:translate-x-full.lg\:right-0.lg\:mt-0.lg\:pl-2 {
						&, > div.flex.gap-1 {
							gap: 0;
						}
						button {
							padding: 3px
						}
					}

					& when(@mobileLayout = 1), (@hideAvatars = 1) {
						& when(@hideAvatars = 1) {
							width: 100%;
						} & when(@hideAvatars = 0) {
							@media (min-width: 1024px) {
								width: 100%;
							}
						}

						/* ===== Message Text ===== */
						> div:nth-child(2n) {
							padding: 0;

							/* ===== Action Button Group ===== */
							> div.lg\:absolute.lg\:top-0.lg\:translate-x-full.lg\:right-0.lg\:mt-0.lg\:pl-2 {
								position: relative;
								transform: none !important;
								margin-top: 0;

								@media (min-width: 1024px) and (max-width: 1536px) {
									padding-left: 0rem;
								}
							}
						}
					}
				}
			}
		}
	}

	/********* SIDEBAR TWEAKS *********/

	.sidebarTweaks() when(@sidebarTweaks = 1) {
		@media (min-width: 768px) {
			/* ===== Sidebar: Main Div ===== */
			div#__next div.overflow-hidden.w-full.h-full.relative.flex.z-0 {
				/* ===== Nav ===== */
				nav[aria-label="Chat history"] {
					&.p-2 {
						padding-left: 0.2rem;
					}

					/* ===== Chat History ===== */
					/* Named timeframe group (Today, Yesterday, etc.) */
					div.sticky.top-0.z-\[14\],
					div.sticky.top-0.z-\[16\] {
						backdrop-filter: brightness(130%);
						filter: brightness(130%);
						margin-left: -0.5rem;
						border-top: 1px inset #6b6e7f;
					}

					/* Chat History Item */
					a.flex.py-3.px-3.items-center.gap-3.relative.rounded-md {
						align-items: flex-start;
						margin: 3px 3px 3px 0;
						padding: .4rem 0 .4rem .4rem;
						gap: 0.3rem;
						line-height: 1.35;
						border-radius: 2px;

						/* Chat Icon */
						> svg {
							width: 0.75rem;
							padding-top: 0.25rem;
						}

						/* Active Chat Item */
						&.bg-gray-800 {
							> div:last-child {
								&.absolute {
									position: inherit;
								}

								/* Action Buttons */
								button.p-1 {
									transition: 0.2s all;
									&, & > svg {
										padding: 0.1rem;
									}

									&:hover {
										filter: brightness(1.5);
										background: rgb(91 93 107 / 25%);
										border-radius: 2px;
									}
								}
							}
						}

						/* Chat Title */
						div.flex-1.text-ellipsis.max-h-5.overflow-hidden.break-all {
							max-height: 3rem;
							font-size: 0.75rem;
							word-break: normal;
							overflow: normal;
							padding-right: 0.5rem;

							> div.bg-gradient-to-l {
								display: none;
							}
						}
					}
				}
			}
		}
	}

	/* Message Accent/Background Colors (Experimental Feature) */

	 .colorize(@darker: false) {
		@defaultBg: if(@darker,
			rgb(52, 53, 65),
			rgb(68, 70, 84)
		);
		@customBg: if(@darker,
			shade(
				mix(@defaultBg, @accentColor, 70%),
				30%
			),
			desaturate(
				darken(
					shade(
						mix(@defaultBg, @accentColor, 45%),
						10%
					), 0%,
				), 10%
			)
		);
		 &:not([type="checkbox"]) {
		background-color: @customBg !important;
		border-left-color: @customBg !important;
		background-image: linear-gradient(180deg,rgba(53,55,64,0), @customBg 58.85%) !important;

		 }
		 &[type="checkbox"] {
			 border: 2px ridge fade(saturate(@accentColor, 40%), 70%);
			 background-color: rgba(@customBg, 0.5);
		 }
	}

	.dark when(@enableAccentColor = 1) {
		// Colorize User Messages and Prompt Input/Textarea:
		&\:bg-gray-700,
		&\:bg-gray-800:not(&\:md\:bg-vert-dark-gradient) {
			.colorize(@darker: true);
		}

		// Colorize ChatGPT Responses:
		&\:bg-\[\#444654\] {
			.colorize;
		}

		// Footer/Disclaimer Area:
		&\:md\:bg-vert-dark-gradient {
			@media (min-width: 768px) {
				.colorize();
				> div > span {
					color: lighten(@accentColor, 65%) !important;
				}
			}
		}
	}
	.sidebarTweaks();
}